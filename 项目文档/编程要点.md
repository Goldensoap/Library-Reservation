# 验证码识别
- 批量获取验证码，http://10.23.4.31/laa/static/code/image?t=  T后面假的是javascript 中的math.random()生成的0到1之间的随机数
- 经过试验和思考，决定采用opencv 对图像前期处理，分离出单个数字，然后再使用minist数据集或者orc识别
- 图像前期处理的流程，很有点玄学调参的感觉，大体流程有以下，灰度化，去除边框，降噪，图像切割。其中降噪很关键，包括二值化，滤波，去除干扰线，二值化和滤波的顺序，滤波使用几次，都很讲究。而去除干扰线，则要用到连通区域标记的方法选出干扰线，删掉，然后用膨胀和腐蚀算法修复数字
- 经过进一步分析，数字位置基本保持不变，线的特征是一条贯穿，同时在左边有几条短线干扰。
- 经过几小时的思考，发觉对灰度图进行卷积操作，可能会带来意想不到的效果。经过查看，一个干扰线的宽度大概不会超过3*3像素，通过一个简单的卷积核，预测可以看到一条数值较大的线贯穿整个图片，再用寻找连通线的方法就简单了许多，甚至不用考虑邻域。
- 手动调整卷积核的途中，我感觉到了数理基础的重要性。
- 经过几天的探索，现在对于处理干扰线有了更多的手段。 包括膨胀和腐蚀，不同卷积核的叠加使用，二值化，滤波
- 使用selenium 模拟，目前不添加翻页功能，仅预约前六个研习室.
- python的浅拷贝也就是指针，再一次坑了我
```python
def time_standard(timestr:str):
    timelist = timestr.split()
    standard = []
    total = ['','']
    for i in timelist:
        numb = i.split(':')
        total[0] = eval(numb[0])*60+eval(numb[1])
        total[1] = total[0]+130
        total[0] = str(total[0])
        total[1] = str(total[1])
        standard.append(total)
    
    return standard

```
- 这个函数，最后返回的列表是三个相同值的列表。。。。(total定义在循环外惹的祸)
- seleium 还可以直接加载JS脚本，修改页面属性，十分方便
- 配置文件内不能用中文，还是编码问题，不知道为什么ini里的是GBK，并且重新编码保存也不管用
- matploit 的Bicubic Interpolation (双三次插值) 感觉竟有奇效。果然，在放大原图像后，效果好上很多
- 切割还是一个不小的问题，不过去除干扰线已经OK。在1和其他数字有较大粘连的情况下，切割大概率会失败。
- 前期处理有两个因素会大幅影响后续，1是一直在改善的各种优化策略，最后有几个特定类型的数字效果会很差，还有就是切割的成功率，如果碰上特定的图（比例不小），切割必定失败。
- 神经网络的效果意外的好，如此小的样本集就可以产生很棒的效果
- python的跨三层文件夹互相导入，还是有问题，包导入的逻辑我还是没想清楚
- 减少跨层以后，循环包导入（两个包分别互相导入）又卡了我一手
- linux下，驱动要更换，更换为支持arm的chromium-chromedriver，使用apt安装,路径在/usr/lib/chromium-browser/chromedriver
- linux下使用cron 进行定时任务，运行bash脚本，bash脚本负责切换python环境与启动程序
- ~~BUG：密码错误并不能返回正确的提示，网页弹出的其他提示也没法反馈~~
- ~~预定结果没有显示~~
- ~~程序有概率推出chrome 会卡死，可能需要延时~~